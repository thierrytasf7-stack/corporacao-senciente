# AIOS IDE Sync Configuration
# Automatically sync agents, tasks, checklists, and workflows to IDE configurations
#
# Usage:
#   1. Copy this file to your project root as .aios-sync.yaml
#   2. Configure active_ides for your setup
#   3. Add pack_aliases for your squads
#   4. Run *command to sync components
#
# Documentation: https://synkra.dev/docs/ide-sync

version: "1.0.0"

# ═══════════════════════════════════════════════════════════════════════════════
# ACTIVE IDEs
# ═══════════════════════════════════════════════════════════════════════════════
# Uncomment the IDEs you want to sync to
active_ides:
  - claude    # Claude Code (.claude/commands/)
  - cursor    # Cursor IDE (.cursor/rules/)
  # - windsurf  # Windsurf IDE (.windsurf/)
  # - gemini    # Google Gemini (.gemini/)
  # - trae      # Trae IDE (.trae/)
  # - cline     # Cline (.cline/)

# ═══════════════════════════════════════════════════════════════════════════════
# PACK ALIASES
# ═══════════════════════════════════════════════════════════════════════════════
# Maps directory name → command prefix
# Example: squads/legal/ → .claude/commands/Legal/
pack_aliases:
  # Add your squads here:
  # squad-name: CommandPrefix
  # legal: Legal
  # copy: Copy
  # hr: HR

# ═══════════════════════════════════════════════════════════════════════════════
# SYNC MAPPINGS
# ═══════════════════════════════════════════════════════════════════════════════
# Source → destination patterns
# Use {pack} placeholder for dynamic pack name substitution
sync_mappings:

  # Agents - sync to all IDEs
  squad_agents:
    source: "squads/*/agents/"
    destinations:
      claude:
        - path: ".claude/commands/{pack}/agents/"
          format: "md"
          wrapper: "none"
      cursor:
        - path: ".cursor/rules/"
          format: "mdc"
          wrapper: "cursor-rule"
      windsurf:
        - path: ".windsurf/{pack}/agents/"
          format: "md"
          wrapper: "none"
      gemini:
        - path: ".gemini/agents/"
          format: "md"
          wrapper: "none"
      trae:
        - path: ".trae/{pack}/agents/"
          format: "md"
          wrapper: "none"

  # Tasks - sync to Claude only by default
  squad_tasks:
    source: "squads/*/tasks/"
    destinations:
      claude:
        - path: ".claude/commands/{pack}/tasks/"
          format: "md"
          wrapper: "none"

  # Workflows - sync to Claude and Cursor
  squad_workflows:
    source: "squads/*/workflows/"
    destinations:
      claude:
        - path: ".claude/commands/{pack}/workflows/"
          format: "md"
          wrapper: "none"
      cursor:
        - path: ".cursor/rules/workflows/"
          format: "mdc"
          wrapper: "cursor-rule"

  # Checklists - Claude only
  squad_checklists:
    source: "squads/*/checklists/"
    destinations:
      claude:
        - path: ".claude/commands/{pack}/checklists/"
          format: "md"
          wrapper: "none"

  # Data/Knowledge - Claude only
  squad_data:
    source: "squads/*/data/"
    destinations:
      claude:
        - path: ".claude/commands/{pack}/data/"
          format: "md"
          wrapper: "none"

# ═══════════════════════════════════════════════════════════════════════════════
# WRAPPERS
# ═══════════════════════════════════════════════════════════════════════════════
# Templates for different IDE formats
wrappers:
  # Cursor MDC format with frontmatter
  cursor-rule:
    prepend: |
      ---
      description: {description}
      globs: []
      alwaysApply: false
      ---

      {content}
    extract_description: true  # Extract from agent whenToUse or first paragraph

  # Claude slash command format
  slash-command:
    prepend: |
      # /{filename} Command

      When this command is used, adopt the following agent persona:

      {content}

  # No transformation
  none:
    prepend: ""

# ═══════════════════════════════════════════════════════════════════════════════
# FILE FILTERS
# ═══════════════════════════════════════════════════════════════════════════════
file_filters:
  include:
    - "*.md"
    - "*.yaml"
    - "*.yml"
  exclude:
    - "README.md"
    - "*.test.md"
    - "*.draft.md"
    - ".DS_Store"
    - "*.bak"

# ═══════════════════════════════════════════════════════════════════════════════
# BEHAVIOR
# ═══════════════════════════════════════════════════════════════════════════════
behavior:
  auto_sync_on_commit: false      # Run sync before every commit (requires git hook)
  create_missing_dirs: true       # Create destination directories if missing
  backup_before_sync: false       # Create .bak files before overwriting
  validate_after_sync: true       # Validate synced files
  log_sync_operations: true       # Log to .aios-sync.log
  fail_on_error: false           # Don't block on sync errors (warn only)

# ═══════════════════════════════════════════════════════════════════════════════
# EXCLUSIONS
# ═══════════════════════════════════════════════════════════════════════════════
exclusions:
  - "*.bak"
  - "*.tmp"
  - "*-test.md"
  - "INTERNAL-*.md"
  - ".state.yaml"
  - "archive/*"

# ═══════════════════════════════════════════════════════════════════════════════
# VALIDATION
# ═══════════════════════════════════════════════════════════════════════════════
validation:
  check_yaml_valid: true          # Validate YAML blocks in markdown
  check_no_hardcoded_paths: true  # Warn if absolute paths found
  check_dependencies_exist: true  # Validate referenced dependencies exist

# ═══════════════════════════════════════════════════════════════════════════════
# LOGGING
# ═══════════════════════════════════════════════════════════════════════════════
logging:
  enabled: true
  log_file: ".aios-sync.log"
  log_level: "info"  # debug, info, warn, error
  max_log_size_mb: 10
  rotate_logs: true
