{
  "schema": "aios-gotchas-v1",
  "version": "1.0.0",
  "generatedAt": "2026-01-29T03:31:04.350Z",
  "statistics": {
    "total": 4,
    "bySeverity": {
      "high": 3,
      "medium": 1,
      "low": 0
    },
    "byCategory": {
      "State Management": 1,
      "API": 2,
      "Other": 1
    },
    "insightsScanned": 1
  },
  "gotchas": [
    {
      "id": "gotcha-STORY-7.4-TEST-3a83f021",
      "title": "Zustand Persist Type Inference",
      "category": "State Management",
      "wrong": "const useStore = create(\n  persist((set) => ({ ... }), { name: 'store' })\n);",
      "right": "const useStore = create<StoreType>()(\n  persist((set) => ({ ... }), { name: 'store' })\n);",
      "reason": "Without explicit type parameter and extra parentheses, TypeScript cannot infer the store type correctly.",
      "severity": "medium",
      "discoveredAt": "2026-01-29T03:00:00Z",
      "storyId": "STORY-7.4-TEST",
      "relatedFiles": [
        "src/stores/authStore.ts"
      ],
      "tags": []
    },
    {
      "id": "gotcha-STORY-7.4-TEST-7afb29c0",
      "title": "Fetch Error Handling",
      "category": "API",
      "wrong": "const data = await fetch(url).then(r => r.json());",
      "right": "const response = await fetch(url);\nif (!response.ok) {\n  throw new Error(`HTTP ${response.status}`);\n}\nconst data = await response.json();",
      "reason": "fetch() doesn't throw on HTTP errors (4xx, 5xx), only on network failures.",
      "severity": "high",
      "discoveredAt": "2026-01-29T03:00:00Z",
      "storyId": "STORY-7.4-TEST",
      "relatedFiles": [
        "src/lib/api.ts"
      ],
      "tags": []
    },
    {
      "id": "gotcha-STORY-7.4-TEST-353c57b",
      "title": "React useEffect Cleanup",
      "category": "Other",
      "wrong": "useEffect(() => {\n  fetchData();\n}, [id]);",
      "right": "useEffect(() => {\n  let cancelled = false;\n  const fetch = async () => {\n    const data = await fetchData();\n    if (!cancelled) setData(data);\n  };\n  fetch();\n  return () => { cancelled = true; };\n}, [id]);",
      "reason": "Without cleanup, race conditions can occur when the component unmounts or dependencies change before the async operation completes.",
      "severity": "high",
      "discoveredAt": "2026-01-29T03:00:00Z",
      "storyId": "STORY-7.4-TEST",
      "relatedFiles": [],
      "tags": []
    },
    {
      "id": "gotcha-STORY-7.4-TEST-0",
      "title": "Zustand persist middleware requires async hydration - com...",
      "category": "API",
      "wrong": "",
      "right": "",
      "reason": "Zustand persist middleware requires async hydration - common pitfall is to not wait for hydration",
      "severity": "high",
      "discoveredAt": "2026-01-29T03:00:00Z",
      "storyId": "STORY-7.4-TEST",
      "relatedFiles": [
        "src/stores/authStore.ts"
      ],
      "tags": []
    }
  ],
  "categories": {
    "State Management": [
      {
        "id": "gotcha-STORY-7.4-TEST-3a83f021",
        "title": "Zustand Persist Type Inference",
        "category": "State Management",
        "wrong": "const useStore = create(\n  persist((set) => ({ ... }), { name: 'store' })\n);",
        "right": "const useStore = create<StoreType>()(\n  persist((set) => ({ ... }), { name: 'store' })\n);",
        "reason": "Without explicit type parameter and extra parentheses, TypeScript cannot infer the store type correctly.",
        "severity": "medium",
        "discoveredAt": "2026-01-29T03:00:00Z",
        "storyId": "STORY-7.4-TEST",
        "relatedFiles": [
          "src/stores/authStore.ts"
        ],
        "tags": []
      }
    ],
    "API": [
      {
        "id": "gotcha-STORY-7.4-TEST-7afb29c0",
        "title": "Fetch Error Handling",
        "category": "API",
        "wrong": "const data = await fetch(url).then(r => r.json());",
        "right": "const response = await fetch(url);\nif (!response.ok) {\n  throw new Error(`HTTP ${response.status}`);\n}\nconst data = await response.json();",
        "reason": "fetch() doesn't throw on HTTP errors (4xx, 5xx), only on network failures.",
        "severity": "high",
        "discoveredAt": "2026-01-29T03:00:00Z",
        "storyId": "STORY-7.4-TEST",
        "relatedFiles": [
          "src/lib/api.ts"
        ],
        "tags": []
      },
      {
        "id": "gotcha-STORY-7.4-TEST-0",
        "title": "Zustand persist middleware requires async hydration - com...",
        "category": "API",
        "wrong": "",
        "right": "",
        "reason": "Zustand persist middleware requires async hydration - common pitfall is to not wait for hydration",
        "severity": "high",
        "discoveredAt": "2026-01-29T03:00:00Z",
        "storyId": "STORY-7.4-TEST",
        "relatedFiles": [
          "src/stores/authStore.ts"
        ],
        "tags": []
      }
    ],
    "Other": [
      {
        "id": "gotcha-STORY-7.4-TEST-353c57b",
        "title": "React useEffect Cleanup",
        "category": "Other",
        "wrong": "useEffect(() => {\n  fetchData();\n}, [id]);",
        "right": "useEffect(() => {\n  let cancelled = false;\n  const fetch = async () => {\n    const data = await fetchData();\n    if (!cancelled) setData(data);\n  };\n  fetch();\n  return () => { cancelled = true; };\n}, [id]);",
        "reason": "Without cleanup, race conditions can occur when the component unmounts or dependencies change before the async operation completes.",
        "severity": "high",
        "discoveredAt": "2026-01-29T03:00:00Z",
        "storyId": "STORY-7.4-TEST",
        "relatedFiles": [],
        "tags": []
      }
    ]
  }
}