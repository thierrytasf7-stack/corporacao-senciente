# Protocolos de Conviv√™ncia - Orquestra de CLIs

## üéº Vis√£o Geral

A **Orquestra de CLIs** √© um sistema de colabora√ß√£o entre ferramentas de IA especializadas, onde cada CLI tem um papel espec√≠fico no desenvolvimento da Corpora√ß√£o Senciente.

---

## üé≠ As Duas Colunas (Jachin e Boaz)

### Aider CLI - O Maestro (Jachin)
**Especialidade:** Racioc√≠nio, Arquitetura e L√≥gica Complexa

**Quando usar:**
- ‚úÖ Mudan√ßas estruturais no c√≥digo
- ‚úÖ Cria√ß√£o de novos m√≥dulos e servi√ßos
- ‚úÖ L√≥gica complexa de agentes
- ‚úÖ Refatora√ß√µes arquiteturais
- ‚úÖ Integra√ß√£o de sistemas
- ‚úÖ Debugging de problemas complexos

**Modelos configurados:**
- **Principal:** Claude 4 Sonnet (racioc√≠nio e arquitetura)
- **Editor:** DeepSeek R1 (implementa√ß√£o r√°pida)

---

### Qwen CLI - A Escriba (Boaz)
**Especialidade:** Documenta√ß√£o, Tradu√ß√£o e C√≥digo Repetitivo

**Quando usar:**
- ‚úÖ Gerar READMEs e documenta√ß√£o t√©cnica
- ‚úÖ Documenta√ß√£o JSDoc/Docstrings
- ‚úÖ Tradu√ß√£o de interfaces (PT/EN)
- ‚úÖ Componentes repetitivos de Front-end
- ‚úÖ Gera√ß√£o de testes unit√°rios
- ‚úÖ Refatora√ß√£o de c√≥digo legado

**Modelo configurado:**
- **Principal:** Qwen 2.5 Coder 72B (via OpenRouter ou DashScope)

---

## üîÑ Sistema de Handoff (Passagem de Bast√£o)

### Fluxo Autom√°tico

```mermaid
graph LR
    A[Comando Recebido] --> B{Tipo de Tarefa?}
    B -->|Estrutural| C[Aider CLI]
    B -->|Documenta√ß√£o| D[Qwen CLI]
    C --> E[Aider Completa]
    E --> F[Git Commit]
    F --> G[Trigger Qwen]
    G --> D
    D --> H[Documenta√ß√£o Criada]
    H --> I[Git Commit]
```

### Regras de Handoff

1. **Aider ‚Üí Qwen (Autom√°tico)**
   - Quando Aider cria um novo m√≥dulo
   - Sistema detecta commit sem README
   - Qwen √© disparada automaticamente para documentar

2. **Qwen ‚Üí Aider (Manual)**
   - Quando documenta√ß√£o revela necessidade de mudan√ßa estrutural
   - Usu√°rio decide se aciona Aider

3. **Handoff Expl√≠cito**
   - Comando: `/handoff qwen "documentar m√≥dulo X"`
   - Comando: `/handoff aider "refatorar componente Y"`

---

## üìñ Interoperabilidade

### Como uma CLI l√™ o que a outra fez

#### Via Git Logs
```bash
# Aider verifica √∫ltimos commits da Qwen
git log --author="Qwen CLI" --since="1 hour ago" --oneline

# Qwen verifica m√≥dulos criados pelo Aider
git log --author="Aider CLI" --diff-filter=A --name-only
```

#### Via Metadados de Commit
```
Formato padr√£o de commit:

AI: [CLI_NAME] [MODULE] Description

Exemplos:
- AI: [Aider] [Backend] Criado servi√ßo de orquestra√ß√£o de CLIs
- AI: [Qwen] [Docs] Documentado m√≥dulo cli_orchestrator.py
```

#### Via Arquivo de Estado
```json
// .cli_state.json
{
  "last_aider_commit": "abc123",
  "last_qwen_commit": "def456",
  "pending_documentation": [
    "backend/core/services/cli_orchestrator.py",
    "backend/core/services/aider_service.py"
  ],
  "pending_refactoring": []
}
```

---

## üõ°Ô∏è Protocolo de Conflitos

### Quando as CLIs discordam

**Cen√°rio:** Aider cria c√≥digo que Qwen considera mal document√°vel

**Resolu√ß√£o:**
1. Qwen adiciona coment√°rio no c√≥digo: `// TODO: Refatorar para melhor documentabilidade`
2. Qwen cria issue no GitHub com tag `cli-conflict`
3. Usu√°rio decide se aceita sugest√£o da Qwen

**Prioridade:** Aider tem prioridade em decis√µes arquiteturais, Qwen em clareza de documenta√ß√£o

---

## üìã Comandos Padronizados

### Para Aider

```bash
# Criar novo m√≥dulo
aider --message "criar m√≥dulo de orquestra√ß√£o de CLIs em backend/core/services/"

# Refatorar c√≥digo existente
aider --message "refatorar backend/agents/whatsapp_commander.py para usar async/await"

# Debugging
aider --message "debugar erro de conex√£o no ForgeContext.tsx"
```

### Para Qwen

```bash
# Documentar m√≥dulo
qwen-code-cli --task "documentar backend/core/services/cli_orchestrator.py com docstrings e README"

# Traduzir interface
qwen-code-cli --task "traduzir componentes de frontend/src/components/ para portugu√™s"

# Gerar testes
qwen-code-cli --task "gerar testes unit√°rios para backend/core/services/aider_service.py"
```

---

## üéØ Matriz de Decis√£o

| Tarefa | Aider | Qwen | Ambos |
|--------|-------|------|-------|
| Criar novo agente Python | ‚úÖ | ‚ùå | ‚ùå |
| Documentar agente criado | ‚ùå | ‚úÖ | ‚ùå |
| Refatorar l√≥gica complexa | ‚úÖ | ‚ùå | ‚ùå |
| Criar componente React simples | ‚ùå | ‚úÖ | ‚ùå |
| Criar componente React complexo | ‚úÖ | ‚ùå | ‚ùå |
| Traduzir UI | ‚ùå | ‚úÖ | ‚ùå |
| Integrar API externa | ‚úÖ | ‚ùå | ‚ùå |
| Documentar API | ‚ùå | ‚úÖ | ‚ùå |
| Criar workflow CI/CD | ‚úÖ | ‚ùå | ‚ùå |
| Documentar workflow | ‚ùå | ‚úÖ | ‚ùå |
| Debugging de erro cr√≠tico | ‚úÖ | ‚ùå | ‚ùå |
| Gerar changelog | ‚ùå | ‚úÖ | ‚ùå |
| Criar nova feature completa | ‚ùå | ‚ùå | ‚úÖ |

---

## üîê Seguran√ßa e Valida√ß√£o

### Valida√ß√£o Cruzada

1. **Aider cria c√≥digo ‚Üí Qwen valida documentabilidade**
   - Se c√≥digo n√£o √© document√°vel, Qwen alerta

2. **Qwen gera documenta√ß√£o ‚Üí Aider valida precis√£o t√©cnica**
   - Se documenta√ß√£o est√° incorreta, Aider corrige

### Aprova√ß√£o Humana

**Obrigat√≥ria para:**
- Mudan√ßas em arquivos de configura√ß√£o cr√≠ticos (`.env`, `config/`)
- Altera√ß√µes em schemas de banco de dados
- Modifica√ß√µes em rotas de API p√∫blicas
- Refatora√ß√µes que afetam > 10 arquivos

**Opcional para:**
- Documenta√ß√£o
- Testes unit√°rios
- Componentes de UI isolados

---

## üìä M√©tricas de Sucesso

### KPIs da Orquestra

- **Taxa de Handoff Bem-Sucedido:** > 90%
- **Tempo M√©dio de Handoff:** < 30 segundos
- **Cobertura de Documenta√ß√£o:** > 80% dos m√≥dulos
- **Taxa de Conflito:** < 5%

### Logs de Auditoria

```json
{
  "timestamp": "2026-02-01T01:00:00Z",
  "cli": "aider",
  "task": "criar m√≥dulo cli_orchestrator.py",
  "status": "completed",
  "duration_seconds": 45,
  "files_changed": 3,
  "handoff_to": "qwen",
  "handoff_reason": "documenta√ß√£o necess√°ria"
}
```

---

## üöÄ Evolu√ß√£o Futura

### Fase 1 (Atual)
- ‚úÖ Aider + Qwen instaladas
- ‚úÖ Protocolos de conviv√™ncia definidos
- ‚úÖ Handoff manual

### Fase 2 (Pr√≥xima)
- [ ] Handoff autom√°tico via git hooks
- [ ] Dashboard de m√©tricas da Orquestra
- [ ] Integra√ß√£o com portal WhatsApp

### Fase 3 (Futuro)
- [ ] Claude Code CLI (terceira coluna)
- [ ] Cursor CLI (quarta coluna)
- [ ] Sistema de vota√ß√£o entre CLIs para decis√µes complexas

---

## üìö Refer√™ncias

- [Aider Documentation](https://aider.chat/docs/)
- [Qwen Code Documentation](https://qwenlm.github.io/)
- [Corpora√ß√£o Senciente - DOCUMENTO_UNICO_VERDADE.md](file:///c:/Users/User/Desktop/Sencient-Coorporation/Diana-Corporacao-Senciente/DOCUMENTO_UNICO_VERDADE.md)
