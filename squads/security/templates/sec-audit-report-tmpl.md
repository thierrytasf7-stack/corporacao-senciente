# Security Audit Report

**Projeto:** Diana Corporacao Senciente
**Data:** {date}
**Auditor:** Sentinel (Security Engineer)
**Escopo:** {scope}
**Security Score:** {score}/100 (Grade {grade})

---

## Executive Summary

| Metrica | Valor |
|---------|-------|
| Total Findings | {total_findings} |
| Critical | {critical_count} |
| High | {high_count} |
| Medium | {medium_count} |
| Low | {low_count} |
| Security Score | {score}/100 |
| Gate Result | {gate_result} |

**Resumo:** {executive_summary}

---

## 1. Code Security (SAST)

### Findings

| # | Severidade | Tipo | Arquivo | Linha | Descricao |
|---|-----------|------|---------|-------|-----------|
| {n} | {severity} | {type} | {file} | {line} | {description} |

### Metricas OWASP

| OWASP Category | Status | Findings |
|----------------|--------|----------|
| A01 - Broken Access Control | {status} | {count} |
| A02 - Cryptographic Failures | {status} | {count} |
| A03 - Injection | {status} | {count} |
| A04 - Insecure Design | {status} | {count} |
| A05 - Security Misconfiguration | {status} | {count} |
| A06 - Vulnerable Components | {status} | {count} |
| A07 - Auth Failures | {status} | {count} |
| A08 - Software/Data Integrity | {status} | {count} |
| A09 - Logging/Monitoring Failures | {status} | {count} |
| A10 - SSRF | {status} | {count} |

---

## 2. Dependency Security

### npm audit Results

| Package | Severidade | CVE | Fix Disponivel |
|---------|-----------|-----|----------------|
| {package} | {severity} | {cve} | {fix} |

### Dependency Health

| Metrica | Valor | Threshold | Status |
|---------|-------|-----------|--------|
| Critical CVEs | {count} | 0 | {status} |
| High CVEs | {count} | 0 | {status} |
| Medium CVEs | {count} | <= 5 | {status} |
| Abandoned Packages | {count} | 0 | {status} |
| Lock File Integrity | {status} | Valid | {status} |

---

## 3. Secret Detection

### Findings

| # | Tipo | Arquivo | Valor (masked) | Risco |
|---|------|---------|----------------|-------|
| {n} | {type} | {file} | {masked_value} | {risk} |

### .env Audit

| Check | Status |
|-------|--------|
| .env in .gitignore | {status} |
| .env not committed | {status} |
| .env.example has placeholders only | {status} |
| No secrets in config files | {status} |

---

## 4. API Security

### Endpoint Inventory

| Endpoint | Auth | Rate Limit | Input Val | CORS | Headers | Score |
|----------|------|-----------|-----------|------|---------|-------|
| {endpoint} | {auth} | {rate} | {input} | {cors} | {headers} | {score} |

### Overall API Score: {api_score}/100 (Grade {api_grade})

---

## 5. Recommendations

### Immediate (Critical/High)

1. {recommendation_1}
2. {recommendation_2}

### Short-term (Medium - this sprint)

1. {recommendation_3}
2. {recommendation_4}

### Long-term (Low - backlog)

1. {recommendation_5}

---

## 6. Action Items

| # | Item | Owner | Severidade | Deadline |
|---|------|-------|-----------|----------|
| 1 | {action} | {owner} | {severity} | {deadline} |

---

## Comparison with Previous Audit

| Metrica | Previous | Current | Delta |
|---------|----------|---------|-------|
| Total Findings | {prev} | {current} | {delta} |
| Critical | {prev} | {current} | {delta} |
| High | {prev} | {current} | {delta} |
| Security Score | {prev} | {current} | {delta} |

---

*Report generated by Sentinel, Security Engineer*
*Trust nothing, verify everything*
